FROM ghcr.io/astral-sh/uv:python3.13-alpine

WORKDIR /app

RUN apk add --no-cache \
    curl \
    bash

COPY pyproject.toml ./

RUN --mount=type=cache,target=/root/.cache/uv \
    uv pip install --system nox>=2025.2.9

COPY . .

ENV PYTHONPATH=/app:/app/src
ENV PYTHONUNBUFFERED=1

CMD ["nox", "--session", "tests"]